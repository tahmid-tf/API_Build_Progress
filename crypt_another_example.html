<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body></body>
</html>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script>
  // (B) ENCRYPT & DECRYPT FUNCTIONS
  var crypt = {
    // (B1) THE SECRET KEY
    secret: "CIPHERKEY",

    // (B2) ENCRYPT
    encrypt: (clear) => {
      var cipher = CryptoJS.AES.encrypt(clear, crypt.secret);
      cipher = cipher.toString();
      return cipher;
    },

    // (B3) DECRYPT
    decrypt: (cipher) => {
      var decipher = CryptoJS.AES.decrypt(cipher, crypt.secret);
      decipher = decipher.toString(CryptoJS.enc.Utf8);
      return decipher;
    },
  };

  // (C) TEST
  // (C1) ENCRYPT CLEAR TEXT
  var cipher = crypt.encrypt(
    "bearer 2|eO49Zt7P4iTDHEQ2GWJI8ME4jPTdtN00KmS4N7g7"
  );
  console.log(cipher);

  // (C2) DECRYPT CIPHER TEXT
  var decipher = crypt.decrypt(cipher);
  console.log(decipher);
</script>
